webpackJsonp([6],{DXyG:function(t,e){},ShNd:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o("Dd8w"),i=o.n(s),r=o("NYxO"),n=o("IcnI"),a=o("y2MC"),u=o("FN8c"),m=o("8Q2T"),l=o("vfpe"),p=o("26Oo"),c={name:"forumpost",components:{Simditor:l.a,Pagination:p.a},mixins:[a.a],data:function(){return{forumpostID:"",submitting:!1,forumpost:{title:"",content:"",author:{username:""}},visible:!1,ConfirmDeleteForumPost:!1,ConfirmDeleteForumReply:!1,forumreply:{fa_id:"",content:""},forumreplys:[],limit:10,page:1,total:0,routeName:"",user_grade:u.i,query:{page:1}}},mounted:function(){this.$store.commit(n.b.CHANGE_CONTEST_ITEM_VISIBLE,{menu:!1}),this.init()},methods:i()({},Object(r.mapActions)(["changeDomTitle"]),{init:function(){var t=this;this.$Loading.start(),this.forumpostID=this.$route.params.forumpostID,m.a.getForum(this.forumpostID).then(function(e){t.$Loading.finish();var o=e.data.data;t.changeDomTitle({title:o.title}),t.forumpost=o,t.isSuperAdmin&&(t.visible=!0),t.user.username===t.forumpost.author.username&&(t.visible=!0)},function(){t.$Loading.error()}),this.routeName=this.$route.name;var e=this.$route.query;this.query.page=parseInt(e.page)||1,this.query.page<1&&(this.query.page=1),this.getForumReplyList(1)},ForumPostControl:function(t){1===t&&this.$router.push({name:"Forum-post",query:{id:this.forumpostID}}),2===t&&this.submitforumpost(2),3===t&&this.submitforumpost(3),4===t&&this.submitforumpost(4),0===t&&(this.ConfirmDeleteForumPost=!0)},confirmDeletePost:function(){var t=this;m.a.deleteFourmPost(this.forumpostID).then(function(e){t.$success("Success"),t.$router.push({name:"Forum-list"})})},submitforumpost:function(t){var e=this;if(!1!==this.isSuperAdmin){if(!1===this.website.allow_forum_post)return 2===t&&(this.forumpost.is_top=!this.forumpost.is_top),3===t&&(this.forumpost.is_light=!this.forumpost.is_light),4===t&&(this.forumpost.is_nice=!this.forumpost.is_nice),void this.$error(this.website.website_name+" does't allow to post");var o={id:this.forumpost.id,title:this.forumpost.title,content:this.forumpost.content,is_top:this.forumpost.is_top,is_light:this.forumpost.is_light,is_nice:this.forumpost.is_nice,sort:this.forumpost.sort};m.a.submitFourmPost(o).then(function(t){e.$success("Success")},function(){2===t&&(e.forumpost.is_top=!e.forumpost.is_top),3===t&&(e.forumpost.is_light=!e.forumpost.is_light),4===t&&(e.forumpost.is_nice=!e.forumpost.is_nice)})}else this.$error("User does't have permission")},getForumReplyList:function(t){var e=this,o=(this.page-1)*this.limit;this.query.page=t,m.a.getForumReplyList(o,this.limit,this.forumpostID,this.query).then(function(t){e.total=t.data.data.total,e.forumreplys=t.data.data.results})},submitForumReply:function(){var t=this;if(""!==this.forumreply.content.trim())if(!1!==this.website.allow_forum_reply){this.submitting=!0;var e={fa_id:this.forumpostID,content:this.forumreply.content};m.a.submitFourmReply(e).then(function(e){t.submitting=!1,t.$success("Success"),t.forumreply.content="",t.forumreplys.unshift(e.data.data)},function(){t.submitting=!1})}else this.$error(this.website.website_name+" does't allow to reply");else this.$error("Reply can not be empty!")},confirmDeleteReply:function(){var t=this;m.a.deleteFourmReply(this.forumreplyID).then(function(e){t.$success("Success"),t.getForumReplyList(t.page)})},GoUserHome:function(t){this.$router.push({name:"user-home",query:{username:t}})},backPage:function(){this.$router.go(-1)},goHome:function(){this.$router.push({name:"home"})}}),computed:i()({},Object(r.mapGetters)(["website","user","isSuperAdmin"])),watch:{$route:function(){this.init()}}},_={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.website.allow_forum_post?o("div",{staticClass:"flex-container"},[o("div",{attrs:{id:"forumpost-main"}},[o("Panel",{attrs:{padding:40,shadow:""}},[o("div",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.forumpost.title))]),t._v(" "),o("div",{directives:[{name:"katex",rawName:"v-katex"}],staticClass:"markdown-body",attrs:{id:"forumpost-content"}},[o("p",{staticClass:"title"},[t._v(t._s(t.$t("m.Forum_Content")))]),t._v(" "),o("p",{staticClass:"content",domProps:{innerHTML:t._s(t.forumpost.content)}})])]),t._v(" "),o("Panel",{staticStyle:{"margin-top":"20px"},attrs:{padding:40,shadow:""}},[o("div",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$t("m.Forum_Reply_List")))]),t._v(" "),t.forumreplys.length?t._e():o("div",{key:"no-replys",staticClass:"no-replys"},[o("p",[t._v(t._s(t.$t("m.Forum_No_Reply")))])]),t._v(" "),o("div",{staticStyle:{"margin-top":"-30px","margin-bottom":"30px"}},[t._l(t.forumreplys,function(e){return o("Card",{key:e.id,staticStyle:{"margin-top":"5px"},attrs:{padding:20,"dis-hover":""}},[o("p",{attrs:{slot:"title"},slot:"title"},[e.author.title?o("Tag",{staticStyle:{"margin-top":"-1px"},attrs:{color:e.author.title_color}},[t._v(t._s(e.author.title))]):o("Tag",{staticStyle:{"margin-top":"-1px"},attrs:{color:t.user_grade[e.author.grade].color}},[t._v(t._s(t.user_grade[e.author.grade].name))]),t._v(" "),o("a",{on:{click:function(o){return t.GoUserHome(e.author.username)}}},[t._v("\n              "+t._s(e.author.username)+"\n            ")])],1),t._v(" "),o("p",{attrs:{slot:"extra"},slot:"extra"},[t.visible||e.author.username===t.user.username?o("Button",{staticClass:"delete-Button",attrs:{type:"text"},on:{click:function(o){t.ConfirmDeleteForumReply=!0,t.forumreplyID=e.id}}},[t._v("\n                    "+t._s(t.$t("m.Forum_Delete")))]):t._e(),t._v("\n            "+t._s(t._f("localtime")(e.create_time))+"   # "+t._s(e.floor)+"\n          ")],1),t._v(" "),o("div",{directives:[{name:"katex",rawName:"v-katex"}],staticClass:"markdown-body",attrs:{id:"forumreply-content"}},[o("p",{staticClass:"content",domProps:{innerHTML:t._s(e.content)}})])])}),t._v(" "),o("Pagination",{attrs:{total:t.total,"page-size":t.limit,current:t.page,"show-sizer":""},on:{"update:pageSize":function(e){t.limit=e},"update:page-size":function(e){t.limit=e},"update:current":function(e){t.page=e},"on-change":t.getForumReplyList,"on-page-size-change":function(e){return t.getForumReplyList(1)}}})],2)]),t._v(" "),o("Card",{attrs:{padding:20,id:"submit-reply","dis-hover":""}},[o("div",{staticClass:"title"},[t._v(t._s(t.$t("m.Forum_Reply")))]),t._v(" "),o("div",{staticStyle:{"margin-left":"20px","margin-right":"20px"}},[o("Simditor",{model:{value:t.forumreply.content,callback:function(e){t.$set(t.forumreply,"content",e)},expression:"forumreply.content"}})],1),t._v(" "),o("Row",{attrs:{type:"flex",justify:"space-between"}},[o("Col",{staticStyle:{"margin-top":"20px"},attrs:{span:12}},[o("Button",{staticClass:"fl-right",attrs:{type:"warning",icon:"edit",loading:t.submitting},on:{click:t.submitForumReply}},[t.submitting?o("span",[t._v(t._s(t.$t("m.Submitting")))]):o("span",[t._v(t._s(t.$t("m.Submit")))])])],1)],1)],1)],1),t._v(" "),o("div",{attrs:{id:"right-column"}},[o("Card",{attrs:{id:"info"}},[o("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[o("Icon",{attrs:{type:"md-information-circle"}}),t._v(" "),o("span",{staticClass:"card-title"},[t._v(t._s(t.$t("m.Forum_Post_Information")))])],1),t._v(" "),o("ul",[o("li",[o("p",[t._v("ID")]),t._v(" "),o("p",[t._v(t._s(t.forumpost.id))])]),t._v(" "),o("li",[o("p",[t._v(t._s(t.$t("m.By")))]),t._v(" "),o("p",[t._v(t._s(t.forumpost.author.username))])]),t._v(" "),o("li",[o("p",[t._v(t._s(t.$t("m.Sort")))]),t._v(" "),o("p",[t._v(t._s(t.website.forum_sort[t.forumpost.sort-1].name))])]),t._v(" "),o("li",[o("p",[t._v(t._s(t.$t("m.Forum_Post_Time")))]),t._v(" "),o("p",[t._v(t._s(t._f("localtime")(t.forumpost.create_time)))])]),t._v(" "),o("li",[o("p",[t._v(t._s(t.$t("m.Forum_Last_Update_Time")))]),t._v(" "),o("p",[t._v(t._s(t._f("localtime")(t.forumpost.last_update_time)))])])])]),t._v(" "),o("div",{staticClass:"VerticalMenu"},[t.visible?o("Card",{staticStyle:{"margin-top":"10px",cursor:"pointer"},attrs:{padding:0,"dis-hover":""}},[o("ul",[o("li",{on:{click:function(e){return e.stopPropagation(),t.ForumPostControl(1)}}},[o("Icon",{attrs:{type:"md-edit"}}),t._v("\n            "+t._s(t.$t("m.Forum_Edit"))+"\n          ")],1),t._v(" "),t.isSuperAdmin?o("li",[o("Icon",{staticStyle:{"margin-left":"2px"},attrs:{type:"md-flag"}}),t._v("\n             "+t._s(t.$t("m.Forum_Top"))+"\n            "),o("i-switch",{staticStyle:{"margin-left":"10px"},on:{"on-change":function(e){return t.ForumPostControl(2)}},model:{value:t.forumpost.is_top,callback:function(e){t.$set(t.forumpost,"is_top",e)},expression:"forumpost.is_top"}})],1):t._e(),t._v(" "),t.isSuperAdmin?o("li",[o("Icon",{staticStyle:{"margin-left":"2px"},attrs:{type:"ios-bulb"}}),t._v("\n             "+t._s(t.$t("m.Forum_Light"))+"\n            "),o("i-switch",{staticStyle:{"margin-left":"10px"},on:{"on-change":function(e){return t.ForumPostControl(3)}},model:{value:t.forumpost.is_light,callback:function(e){t.$set(t.forumpost,"is_light",e)},expression:"forumpost.is_light"}})],1):t._e(),t._v(" "),t.isSuperAdmin?o("li",[o("Icon",{staticStyle:{"margin-left":"-1px"},attrs:{type:"md-star"}}),t._v("\n            "+t._s(t.$t("m.Forum_Nice"))+"\n            "),o("i-switch",{staticStyle:{"margin-left":"10px"},on:{"on-change":function(e){return t.ForumPostControl(4)}},model:{value:t.forumpost.is_nice,callback:function(e){t.$set(t.forumpost,"is_nice",e)},expression:"forumpost.is_nice"}})],1):t._e(),t._v(" "),o("li",{staticClass:"delete",on:{click:function(e){return e.stopPropagation(),t.ForumPostControl(0)}}},[o("Icon",{staticStyle:{"margin-left":"1px"},attrs:{type:"md-trash"}}),t._v("\n              "+t._s(t.$t("m.Forum_Delete"))+"\n          ")],1)])]):t._e()],1)],1),t._v(" "),o("Modal",{attrs:{title:t.$t("m.Forum_Delete")},on:{"on-ok":t.confirmDeletePost},model:{value:t.ConfirmDeleteForumPost,callback:function(e){t.ConfirmDeleteForumPost=e},expression:"ConfirmDeleteForumPost"}},[o("p",[t._v(t._s(t.$t("m.Forum_ConfirmDelete")))])]),t._v(" "),o("Modal",{attrs:{title:t.$t("m.Forum_Delete")},on:{"on-ok":t.confirmDeleteReply},model:{value:t.ConfirmDeleteForumReply,callback:function(e){t.ConfirmDeleteForumReply=e},expression:"ConfirmDeleteForumReply"}},[o("p",[t._v(t._s(t.$t("m.Forum_ConfirmDelete")))])])],1):o("div",{staticClass:"error404"},[o("div",{staticClass:"error404-body-con"},[o("Card",[o("div",{staticClass:"error404-body-con-title"},[t._v("4"),o("span",[o("Icon",{attrs:{type:"ios-navigate-outline"}})],1),t._v("4")]),t._v(" "),o("p",{staticClass:"error404-body-con-message"},[t._v("YOU  LOOK  LOST")]),t._v(" "),o("div",{staticClass:"error404-btn-con"},[o("Button",{staticStyle:{width:"200px"},attrs:{size:"large",type:"primary"},on:{click:t.goHome}},[t._v(t._s(t.$t("m.Go_Home")))]),t._v(" "),o("Button",{staticStyle:{width:"200px","margin-left":"40px"},attrs:{size:"large",type:"primary"},on:{click:t.backPage}},[t._v(t._s(t.$t("m.Back")))])],1)])],1)])},staticRenderFns:[]};var f=o("VU/8")(c,_,!1,function(t){o("DXyG")},"data-v-27e932d0",null);e.default=f.exports}});